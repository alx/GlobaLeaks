{{extend 'layout.html'}}
<style>
div.flash {
background-color: green;
}
</style>
{{if not added:}}
<h1>1. Node Admin <span>| Target list</span></h1>
<p class="intro">
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed semper rutrum nunc, suscipit tincidunt ligula elementum semper. Cras in elit vel libero interdum faucibus. Vivamus vitae tellus vitae velit fermentum scelerisque. Ut ut sapien metus. In ut velit ac leo laoreet fermentum in eu sem
</p>
{{=form}}
{{pass}}

{{if added:}}

<!-- h1>Now go and test a leak out ;)</h1>
<ul>
<li>Name: {{=request.vars.Name}}</li>
<li>Description: {{=request.vars.Description}}</li>
<li>Email: {{=request.vars.email}}</li>
</ul -->
<h1>1. Node Admin <span>| Current Target list</span></h1>
<form><input type="hidden" id="edit" name="edit" /></form>
<table class="targetlist">
<thead>
    <th>Name</th>
    <th>Email</th>
    <th>Description</th>
    <th>Delete</th>
</thead>
<tbody>
{{i=0}}
{{for target in targets:}}
    {{if (i % 2 == 0):}}
    <tr class="even" id="target-{{=target.id}}">
    {{pass}}
    {{if (i % 2 == 1):}}
    <tr class="odd" id="target-{{=target.id}}">
    {{pass}}
        <td class="name">{{=target.name}}</td>
        <td class="email">{{=target.url}}</td>
        <td class="description">{{=target.desc}}</td>
        <td class="delete">
            <button name="delete" onclick="clicked({{=target.id}}, 'delete')">delete</button>
        </td>
    </tr>
    {{i += 1}}
{{pass}}
</table>

<a class="button whistleblower" href="/submit">Be the Whistleblower</a>


<a class="button addtarget" href="/globaleaks/admin/targets">Add target</a>

<div class="clear"></div>

{{pass}}

<script>
function clicked(id, action) {
      jQuery('#edit').val(action + '.' + id);
      ajax('targets', ['edit'], '');
      jQuery('#target-' + id).hide();
      return false;
}
</script>
